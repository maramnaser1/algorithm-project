import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.File;
import java.util.Scanner;

import javax.imageio.ImageIO;

public class MainGreedy {

    // Convert BufferedImage to Color[][]
    public static Color[][] bufferedToColorArray(BufferedImage img) {
        int rows = img.getHeight();
        int cols = img.getWidth();
        Color[][] arr = new Color[rows][cols];

        for (int r = 0; r < rows; r++) {
            for (int c = 0; c < cols; c++) {
                arr[r][c] = new Color(img.getRGB(c, r));
            }
        }
        return arr;
    }

    // Convert Color[][] to BufferedImage
    public static BufferedImage colorArrayToBuffered(Color[][] arr) {
        int rows = arr.length;
        int cols = arr[0].length;

        BufferedImage img = new BufferedImage(cols, rows, BufferedImage.TYPE_INT_RGB);

        for (int r = 0; r < rows; r++) {
            for (int c = 0; c < cols; c++) {
                img.setRGB(c, r, arr[r][c].getRGB());
            }
        }
        return img;
    }

    public static void main(String[] args) {

        Scanner scanner = new Scanner(System.in);

        try {
            // Load test image
            BufferedImage input = ImageIO.read(new File("cartoon(1).jpg"));
           
            // Convert to Color[][]
            Color[][] matrix = bufferedToColorArray(input);

            // Create Greedy seam carver
            GreedySeamCarver gsc = new GreedySeamCarver(matrix);

            // Ask user how many seams to remove
            System.out.print("Enter number of vertical seams to remove: ");
            int numSeamsToRemove = scanner.nextInt();

            // Remove seams
            for (int i = 0; i < numSeamsToRemove; i++) {
                int[] seam = gsc.findVerticalSeamGreedy();
                gsc.removeVerticalSeam(seam);
            }

            // Save new image
            BufferedImage output = colorArrayToBuffered(gsc.getImage());
            ImageIO.write(output, "png", new File("greedy_output.jpg"));

            System.out.println("Done! Check the file: images/greedy_output.jpg");

        } catch (Exception e) {
            System.out.println("Error: " + e);
        } finally {
            scanner.close();
        }
    }
}
